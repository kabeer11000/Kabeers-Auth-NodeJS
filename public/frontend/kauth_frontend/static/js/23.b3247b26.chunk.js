(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{117:function(e,t,n){"use strict";n.d(t,"d",function(){return l}),n.d(t,"a",function(){return d}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return p});var a=n(18),r=n.n(a),c=n(111),o=n(31),i=n(22),u=n(32),s=n(147),l=(n(0),function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a,s,l,d,m=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=m.length>1&&void 0!==m[1]&&m[1],a=document.getElementById("DataContainer"),s={authCode:a.getAttribute("authCode"),clientPublic:a.getAttribute("clientPublic")},a){e.next=5;break}return e.abrupt("return",new Error("Main Element Not Defined"));case 5:return l=function(){var e=Object(o.a)(r.a.mark(function e(){var t,n=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",fetch(t.url,Object(c.a)({},t)).then(function(e){return e.ok?e.json():null}));case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(o.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=void 0,e.next=3,l({url:u.a.authToken,method:"POST",timeout:0,headers:{"Content-Type":"application/x-www-form-urlencoded"},body:Object(i.d)({client_secret:Object(i.e)("client_secret"),client_public:s.clientPublic,auth_code:s.authCode})}).then(function(e){t=e});case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",l({url:u.a.authAllow,method:"POST",timeout:0,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:Object(i.d)({username:t.username,password:t.password,auth_code:s.authCode})}).then(function(e){if(e){if("code"===Object(i.e)("response_type")){var t=new URLSearchParams(e.callback);if(n)return{callback:e.callback.split(/[?#]/)[0],state:t.get("state"),nonce:t.get("nonce")};window.location.href=e.callback}if("token"===Object(i.e)("response_type")){var a=new URLSearchParams(e.callback);return d().then(function(t){if(t)return n?{callback:e.callback.split(/[?#]/)[0],token:JSON.stringify(t),state:a.get("state"),nonce:a.get("nonce")}:void(window.location.href="".concat(e.callback.split(/[?#]/)[0],"?token=").concat(encodeURI(JSON.stringify(t)),"&nonce=").concat(a.get("nonce"),"&state=").concat(a.get("state")))})}}}).catch(function(e){return new Error("Error Response")}));case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),d=function(){var e=Object(o.a)(r.a.mark(function e(t){var n,a=arguments;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]&&a[1],e.abrupt("return",s.a.load().then(function(e){return e.get().then(function(e){return fetch(u.a.chooserLoginTest(n),{credentials:"include",method:"POST",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},timeout:0,body:Object(i.d)(Object(c.a)({deviceId:e.visitorId},n?{user_id:t.user_id,session_token:t.session_token}:{username:t.username,password:t.password}))})})}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),m={sendUpdateEmail:function(){var e=Object(o.a)(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch(u.a.UserDevicesSendEmail,{method:"POST",timeout:0,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:Object(i.d)({username:t.username,password:t.password})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),sendUpdateRequest:function(){var e=Object(o.a)(r.a.mark(function e(t,n,a){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(u.a.UserDevicesUpdate,{method:"POST",timeout:0,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:Object(i.d)({username:t.username,password:t.password,code:n,deviceId:a})});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},p=function(e){return s.a.load().then(function(t){return t.get().then(function(t){return fetch(u.a.GetClientInfo).then(function(e){return e.json()}).then(function(n){return fetch(u.a.CreateAccount,{method:"POST",timeout:0,headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},body:Object(i.d)(Object(c.a)({},n,e,{deviceId:t.visitorId}))}).then(function(e){return e.json()})})})})}},129:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(18),r=n.n(a),c=n(111),o=n(31),i=n(142),u=function(){var e=Object(o.a)(r.a.mark(function e(t){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",new Error("No Account"));case 2:if(null!==localStorage.getItem(i.a.accounts)){e.next=6;break}return e.abrupt("return",localStorage.setItem(i.a.accounts,JSON.stringify([Object(c.a)({},t,{password:void 0})])));case 6:if((n=JSON.parse(localStorage.getItem(i.a.accounts))).find(function(e){return e.user_id===t.user_id})){e.next=11;break}return e.abrupt("return",(n.push(Object(c.a)({},t,{password:void 0})),localStorage.setItem(i.a.accounts,JSON.stringify(n))));case 11:return e.abrupt("return",(n[n.findIndex(function(e){return e.user_id===t.user_id})]=Object(c.a)({},t,{password:void 0}),localStorage.setItem(i.a.accounts,JSON.stringify(n))));case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},142:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var a=n(18),r=n.n(a),c=n(31),o={accounts:"26f2aba545fda02c0f705960ff93fe70"};Object(c.a)(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null===localStorage.getItem("accounts")?null:localStorage.removeItem("accounts"));case 1:case"end":return e.stop()}},e)}))()},227:function(e,t,n){},228:function(e,t){var n=this;window.kauth=function(){return{init:function(e){var t=e.client_id,a=e.scope,r=e.redirect_uri,c=e.state,o=void 0===c?window.crypto.getRandomValues(new Uint32Array(1)).join():c,i=e.nonce,u=void 0===i?window.crypto.getRandomValues(new Uint32Array(1)).join():i;return n.state={client_id:t,redirect_uri:r,scope:a,state:o,nonce:u}},prompt:function(e){var t=e.container;window.console.warn("Prompt Sign in Has Its Own Basic Info Scopes. Please Consider `redirect` or `render` for Custom Scopes"),t.innerHTML='<div><iframe src=""',window.addEventListener("message",function(e){console.log(e.origin),console.log(e.data.msg),"https://example1.com"===e.origin||e.origin},!1)}}},window.kauth().init({client_id:"123456789"}),window.kauth().prompt({container:document.createElement("div")})},305:function(e,t,n){"use strict";n.r(t),n.d(t,"AccountChooser",function(){return x}),n.d(t,"PermsComponent",function(){return I}),n.d(t,"EmbededAccountContext",function(){return N});var a=n(111),r=(n(18),n(31),n(17)),c=n(0),o=n.n(c),i=(n(227),n(169)),u=n(171),s=n(172),l=n(103),d=n(173),m=n(22),p=n(38),f=n(117),b=(n(129),n(156)),h=n(214),w=n(101),v=n(174),g=n(165),E=n(163),O=n(100),y=n(192),S=n(306),j=(n(228),n(167)),k=n(78),x=function(e){var t=o.a.useContext(N),n=Object(r.a)(t,2),c=n[0],b=n[1],h=null===localStorage.getItem("accounts")?null:JSON.parse(localStorage.getItem("accounts"));if(!m.a)return new Error("Main Element Not Defined");var w=o.a.useContext(p.a),v=Object(r.a)(w,2),g=(v[0],v[1],o.a.useState(!1)),E=Object(r.a)(g,2);E[0],E[1];return o.a.createElement(i.a,null,h.map(function(e,t){return o.a.createElement(u.a,{style:{minWidth:"100%"},button:!0,alignItems:"flex-start",onClick:function(){b(Object(a.a)({},c,{backdrop:!0})),Object(f.a)(e).then(function(e){return e.json().then(function(e){return 200===e.status&&b(Object(a.a)({},c,{headersSlideIn:!c.headersSlideIn,accountSelected:!0,account:e,backdrop:!1}))})}).catch(function(e){return b(Object(a.a)({},c,{headersSlideIn:c.headersSlideIn,accountSelected:!1,account:null}))})},key:t},o.a.createElement(s.a,null,o.a.createElement(l.a,{alt:e.username,src:e.account_image})),o.a.createElement(d.a,{primary:e.username,secondary:e.email}))}))},I=function(){var e=o.a.useContext(N),t=Object(r.a)(e,2),n=t[0],c=t[1];return o.a.createElement(O.a,null,o.a.createElement(i.a,null,o.a.createElement(u.a,{style:{minWidth:"100%"},button:!0,alignItems:"flex-start",onClick:function(){c(Object(a.a)({},n,{headersSlideIn:!n.headersSlideIn,accountSelected:!0}))}},o.a.createElement(s.a,null,o.a.createElement(l.a,{alt:n.account.username,src:n.account.account_image})),o.a.createElement(d.a,{primary:n.account.username,secondary:n.account.email}))),o.a.createElement(w.a,{className:"text-center"},o.a.createElement(w.a,{component:"span",className:"mr-1",color:"secondary"},n.app.name),"wants Access to Your Account"),o.a.createElement(w.a,{variant:"overline",component:"div",className:"text-left mt-3"},"This allows",o.a.createElement(w.a,{className:"ml-1",variant:"overline",color:"secondary"},n.app.name)," To:"),o.a.createElement(i.a,{className:"mt-3"},n.app.perms.map(function(e,t){return o.a.createElement(o.a.Fragment,{key:t},o.a.createElement(u.a,{style:{minWidth:"100%"},button:!0,alignItems:"flex-start"},o.a.createElement(s.a,null,o.a.createElement(l.a,{alt:e.title,src:e.image,style:{width:"2rem",height:"2rem"},className:"bg-light",variant:"rounded"})),o.a.createElement(d.a,{primary:"".concat(e.desc),secondary:e.title})),o.a.createElement(v.a,{variant:"inset",component:"li"}))})),o.a.createElement(v.a,{variant:"middle"}),o.a.createElement(E.a,{variant:"contained",className:"w-100 mt-2",onClick:function(){c(Object(a.a)({},n,{backdrop:!n.backdrop})),Object(f.d)(n.account,!0).then(function(e){return console.warn(e)}).catch(function(e){return c(Object(a.a)({},n,{backdrop:!n.backdrop}))})}},"Allow App"))},N=o.a.createContext({headersSlideIn:!0,accountSelected:!1}),C=Object(b.a)(function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},root:{width:"100%"}}}),A=function(){var e=C(),t=o.a.useState({headersSlideIn:!0,accountSelected:!1,backdrop:!1,app:{name:m.a.getAttribute("appName"),icon:m.a.getAttribute("appIcon"),perms:JSON.parse(atob(m.a.getAttribute("appPerms")))}}),n=Object(r.a)(t,2),c=n[0],p=n[1];return o.a.createElement("div",{className:e.root},o.a.createElement(j.a,{open:c.backdrop,className:e.backdrop},o.a.createElement(k.a,{color:"inherit"})),o.a.createElement(N.Provider,{value:[c,p]},o.a.createElement(h.a,{className:"EmbeddedAccountSystem w-100 h-100",style:{position:"fixed",bottom:0,paddingBottom:"2.5rem",borderTopLeftRadius:"1rem",borderTopRightRadius:"1rem",overflow:"hidden",maxHeight:"60vh",height:"100%"},elevation:5},o.a.createElement("div",{className:"d-flex justify-content-center w-100"},o.a.createElement(S.a,null)),o.a.createElement(g.a,{in:c.headersSlideIn,direction:"bottom",style:{position:c.headersSlideIn?"relative":"absolute"}},o.a.createElement("div",null,o.a.createElement(i.a,null,o.a.createElement(u.a,null,o.a.createElement(s.a,null,o.a.createElement(l.a,{src:"/kslogo.png",variant:"rounded"})),o.a.createElement(d.a,{primary:"Sign in with Kabeers Network",secondary:"Sign in to Medium.com with your Kabeers Network Account"}))),o.a.createElement(v.a,{variant:"fullwidth"}))),o.a.createElement("div",{className:"h-100 w-100",style:{overflowY:"scroll"}},o.a.createElement(y.a,{direction:"left",in:!c.accountSelected,style:{position:c.accountSelected?"absolute":"relative",overflowY:"scroll"},mountOnEnter:!0,unmountOnExit:!0},o.a.createElement("div",null,o.a.createElement(x,{setHeader:function(){return p(Object(a.a)({},c,{headersSlideIn:!c.headersSlideIn}))}}))),o.a.createElement(y.a,{mountOnEnter:!0,unmountOnExit:!0,in:c.accountSelected,style:{position:c.accountSelected?"absolute":"relative"}},o.a.createElement("div",null,o.a.createElement(I,null)))))))};A.defaultProps={},t.default=A}}]);
//# sourceMappingURL=23.b3247b26.chunk.js.map